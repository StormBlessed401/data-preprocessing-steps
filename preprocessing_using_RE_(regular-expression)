# Problem 1
# Apply all the preprocessing techniques that you think are necessary
import pandas as pd
import re
import string
import nltk
from nltk.corpus import stopwords

nltk.download('stopwords')
stop_words = set(stopwords.words('english'))

df=pd.read_csv("IMDB Dataset.csv")
df.head()


def clean_text(text):
    text = text.lower()                                # Lowercase
    text = re.sub(r'\d+', '', text)                    # Remove numbers
    text = re.sub(r"http\S+|www\S+", "", text)         # remove links
    text = re.sub(r"<[^>]+>", "", text)                 # remove html tags
    text = text.translate(str.maketrans('', '', string.punctuation))  # Remove punctuation
    text = re.sub(r'\s+', ' ', text).strip()           # Remove extra whitespace
    words = text.split()
    words = [w for w in words if w not in stop_words]  # Remove stopwords
    return ' '.join(words)

# Apply cleaning function
df['CleanReview'] = df['review'].apply(clean_text)
# creating new csv file with the two columns
df[['CleanReview', 'sentiment']].to_csv("cleaned_movie_data.csv", index=False)


# Preview
print(df[['CleanReview', 'sentiment']])
